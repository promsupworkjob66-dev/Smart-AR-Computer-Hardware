<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hardware Quiz - T.Nuch SmartCom</title>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;500;700&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        :root { --neon: #00f2ff; --pink: #ff00cc; --success: #2ecc71; --error: #e74c3c; }
        body { font-family: 'Prompt', sans-serif; background: #050a14; color: white; text-align: center; margin: 0; padding: 20px; min-height: 100vh; }
        .container { max-width: 600px; margin: 20px auto; padding: 25px; background: rgba(255,255,255,0.05); border-radius: 20px; border: 1px solid var(--neon); box-shadow: 0 0 20px rgba(0, 242, 255, 0.2); }
        input { padding: 12px; border-radius: 10px; border: 1px solid var(--neon); width: 80%; margin: 10px 0; background: #0a1a33; color: white; font-family: 'Prompt'; font-size: 1rem; text-align: center; }
        .btn { padding: 15px 30px; background: var(--neon); color: #000; border: none; border-radius: 50px; cursor: pointer; font-weight: bold; font-size: 1.1rem; margin: 10px; transition: 0.3s; box-shadow: 0 4px 15px rgba(0, 242, 255, 0.4); }
        .btn:hover { transform: scale(1.05); background: white; }
        .choice-btn { display: block; width: 100%; padding: 15px; margin: 10px 0; background: rgba(255,255,255,0.05); border: 1px solid var(--neon); color: white; border-radius: 15px; cursor: pointer; text-align: left; font-size: 1.1rem; transition: 0.2s; }
        .choice-btn:hover { background: rgba(0, 242, 255, 0.1); }
        .choice-btn.correct { background: var(--success) !important; border-color: var(--success); }
        .choice-btn.wrong { background: var(--error) !important; border-color: var(--error); }
        #timer { font-size: 1.5rem; color: var(--pink); font-weight: bold; margin-bottom: 10px; }
        .hidden { display: none !important; }
        
        .how-to-play { background: rgba(0, 242, 255, 0.1); padding: 15px; border-radius: 15px; margin: 15px 0; text-align: left; border-left: 4px solid var(--neon); }
        .how-to-play ul { padding-left: 20px; margin: 5px 0; font-size: 0.9rem; color: #ccc; }
    </style>
</head>
<body>

<audio id="bgMusic" src="https://www.soundjay.com/clock/sounds/clock-ticking-2.mp3" loop preload="auto"></audio>
<audio id="correctSound" src="https://www.soundjay.com/buttons/sounds/button-37.mp3" preload="auto"></audio>
<audio id="wrongSound" src="https://www.soundjay.com/buttons/sounds/button-10.mp3" preload="auto"></audio>
<audio id="finishSound" src="https://www.soundjay.com/human/sounds/applause-01.mp3" preload="auto"></audio>
<audio id="comboSound" src="https://www.soundjay.com/human/sounds/human-crowd-cheer-01.mp3" preload="auto"></audio>
    
    <div class="container" id="setup-screen">
        <h2 style="color: var(--neon)">üéÆ Hardware Quiz Game</h2>
        
        <div class="how-to-play">
            <strong style="color: var(--neon)">üöÄ ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Ñ‡∏ß‡πâ‡∏≤‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î:</strong>
            <ul>
                <li>‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏à‡∏≤‡∏Å <b>‡∏™‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå AR</b> ‡πÉ‡∏´‡πâ‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°</li>
                <li><b>‡πÄ‡∏ô‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß:</b> ‡∏´‡∏≤‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô ‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏≠‡∏¢‡∏π‡πà‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤</li>
                <li><b>‡∏ù‡∏∂‡∏Å‡∏ã‡πâ‡∏≥‡πÑ‡∏î‡πâ:</b> ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏â‡∏û‡∏≤‡∏∞ "‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î" ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</li>
            </ul>
        </div>

        <p>‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</p>
        <input type="text" id="player-name" placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• ‡∏´‡∏£‡∏∑‡∏≠ ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà">
        <br>
        <button class="btn" onclick="startQuiz()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö</button>
    </div>

    <div class="container hidden" id="quiz-screen">
        <div id="timer">‡πÄ‡∏ß‡∏•‡∏≤: 0 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</div>
        <h3 id="question-text">‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°...</h3>
        <div id="choices-container"></div>
        <p>‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà <span id="current-pos">1</span> / 10</p>
    </div>

    <div class="container hidden" id="result-screen">
        <h2 style="color: var(--neon);">‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</h2>
        <p id="final-score" style="font-size: 1.5rem; margin: 10px 0;"></p>
        <p id="final-time"></p>
        <p id="record-status" style="color: var(--pink); font-weight: bold;"></p>

        <div id="cert-section" style="display:none; text-align: center; margin: 20px 0; padding: 15px; border: 2px dashed #fbbf24; border-radius: 15px; background: rgba(251, 191, 36, 0.1);">
            <h3 style="color: #fbbf24; margin-bottom: 10px; font-size: 1.1rem;">üéñÔ∏è ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢! ‡∏Ñ‡∏∏‡∏ì‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå</h3>
            <button onclick="generateCertificate()" style="background: #fbbf24; color: #000; padding: 10px 20px; border-radius: 10px; font-weight: bold; border: none; cursor: pointer; font-family: 'Prompt';">
                <i class="fa-solid fa-download"></i> ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥‡∏ö‡∏±‡∏ï‡∏£
            </button>
        </div>

        <hr style="border: 0.5px solid var(--neon); opacity: 0.3; margin: 20px 0;">
        <button class="btn" onclick="location.reload()">üéÆ ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
        <button class="btn" style="background: var(--pink); color: white;" onclick="location.href='index.html'">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
    </div>

    <canvas id="certCanvas" width="1200" height="848" style="display:none;"></canvas>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyAK5UMFATyhnQlq3EDLmG7agFqTKh0BYCM",
            authDomain: "smartcom-ar-quiz.firebaseapp.com",
            projectId: "smartcom-ar-quiz",
            databaseURL: "https://smartcom-ar-quiz-default-rtdb.firebaseio.com/",
            storageBucket: "smartcom-ar-quiz.appspot.com",
            messagingSenderId: "367243958931",
            appId: "1:367243958931:web:3e3c66f54668b8ec66b8ec"
        };
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        const bgMusic = document.getElementById("bgMusic");
        const correctSound = document.getElementById("correctSound");
        const wrongSound = document.getElementById("wrongSound");
        const finishSound = document.getElementById("finishSound");
        const comboSound = document.getElementById("comboSound");

        const rawQuestions = [
            { q: "‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÉ‡∏î‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏™‡∏°‡∏∑‡∏≠‡∏ô '‡∏™‡∏°‡∏≠‡∏á' ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå?", c: ["RAM", "CPU", "SSD"], a: "CPU" },
            { q: "‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏£‡πá‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô‡∏Ñ‡∏∑‡∏≠?", c: ["SSD", "PSU", "Mainboard"], a: "SSD" },
            { q: "‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÉ‡∏î‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß‡∏Ç‡∏ì‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô?", c: ["SSD", "CPU", "RAM"], a: "RAM" },
            { q: "‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ô‡∏µ‡πâ ‡∏à‡∏∞‡∏à‡πà‡∏≤‡∏¢‡πÑ‡∏ü‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ?", c: ["CASE", "PSU", "RAM"], a: "PSU" },
            { q: "‡πÅ‡∏ú‡∏á‡∏ß‡∏á‡∏à‡∏£‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏∏‡∏Å‡∏ä‡∏¥‡πâ‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô‡∏Ñ‡∏∑‡∏≠?", c: ["Mainboard", "SSD", "CPU"], a: "Mainboard" },
            { q: "‡∏ï‡∏±‡∏ß‡∏ñ‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏ß‡∏¢‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏ù‡∏∏‡πà‡∏ô‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ß‡πà‡∏≤?", c: ["PSU", "Mainboard", "CASE"], a: "CASE" },
            { q: "‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏Ç‡∏≠‡∏á CPU ‡∏°‡∏µ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ß‡∏±‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏∞‡πÑ‡∏£?", c: ["Watt", "GHz", "GB"], a: "GHz" },
            { q: "RAM ‡∏¢‡πà‡∏≠‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤‡∏≠‡∏∞‡πÑ‡∏£?", c: ["Read Access Memory", "Random Access Memory", "Real Action Memory"], a: "Random Access Memory" },
            { q: "‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÉ‡∏î‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏µ‡πâ‡∏ó‡∏ô‡∏ó‡∏≤‡∏ô‡∏ï‡πà‡∏≠‡πÅ‡∏£‡∏á‡∏Å‡∏£‡∏∞‡πÅ‡∏ó‡∏Å‡πÑ‡∏î‡πâ‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤?", c: ["Hard Disk", "SSD", "CD-ROM"], a: "SSD" },
            { q: "Socket ‡∏ö‡∏ô‡πÄ‡∏°‡∏ô‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏°‡∏µ‡πÑ‡∏ß‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÉ‡∏™‡πà‡∏™‡∏¥‡πà‡∏á‡πÉ‡∏î?", c: ["CPU", "Power Cable", "Case Fan"], a: "CPU" }
        ];

        let questions = []; 
        let currentQ = 0; 
        let score = 0; 
        let seconds = 0; 
        let timerInterval;
        let comboCount = 0; 
        
        function startQuiz() {
            const name = document.getElementById('player-name').value.trim();
            if(!name) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö");
            
            // ‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏á LocalStorage ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏ó‡∏≥‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥‡∏ö‡∏±‡∏ï‡∏£
            localStorage.setItem('studentName', name);

            bgMusic.play().catch(() => {});
            bgMusic.volume = 0.2;

            questions = rawQuestions.sort(() => Math.random() - 0.5).slice(0, 10);
            document.getElementById('setup-screen').classList.add('hidden');
            document.getElementById('quiz-screen').classList.remove('hidden');
            
            timerInterval = setInterval(() => {
                seconds++;
                document.getElementById('timer').innerText = `‡πÄ‡∏ß‡∏•‡∏≤: ${seconds} ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ`;
            }, 1000);
            showQuestion();
        }

        function showQuestion() {
            const qData = questions[currentQ];
            document.getElementById('question-text').innerText = qData.q;
            document.getElementById('current-pos').innerText = currentQ + 1;
            const container = document.getElementById('choices-container');
            container.innerHTML = "";
            
            const shuffledChoices = [...qData.c].sort(() => Math.random() - 0.5);
            shuffledChoices.forEach(choice => {
                const btn = document.createElement('button');
                btn.className = "choice-btn";
                btn.innerText = choice;
                btn.onclick = () => checkAnswer(choice, btn);
                container.appendChild(btn);
            });
        }

        function checkAnswer(choice, btn) {
            const qData = questions[currentQ];
            const btns = document.querySelectorAll('.choice-btn');
            btns.forEach(b => b.disabled = true);

            if(choice === qData.a) {
                score++;
                comboCount++; 
                btn.classList.add('correct');
                if(comboCount >= 3) {
                    comboSound.currentTime = 0;
                    comboSound.play().catch(() => {});
                } else {
                    correctSound.currentTime = 0;
                    correctSound.play().catch(() => {});
                }
            } else {
                comboCount = 0; 
                btn.classList.add('wrong');
                btns.forEach(b => { if(b.innerText === qData.a) b.classList.add('correct'); });
                wrongSound.currentTime = 0;
                wrongSound.play().catch(() => {});
            }
            
            setTimeout(() => {
                currentQ++;
                if(currentQ < questions.length) showQuestion();
                else finishGame();
            }, 800);
        }

        function finishGame() {
            clearInterval(timerInterval);
            bgMusic.pause();
            finishSound.play().catch(() => {});

            const name = localStorage.getItem('studentName');
            const scorePath = 'scores/' + name.replace(/[.#$\[\]]/g, "_");

            database.ref(scorePath).once('value').then((snapshot) => {
                const oldData = snapshot.val();
                let isNewRecord = false;
                if (!oldData || score > oldData.score || (score === oldData.score && seconds < oldData.time)) {
                    database.ref(scorePath).set({ name, score, time: seconds });
                    isNewRecord = true;
                }
                document.getElementById('record-status').innerText = isNewRecord ? "‚ú® ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÉ‡∏´‡∏°‡πà‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß!" : "‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏≠‡∏µ‡∏Å‡∏ô‡∏¥‡∏î! ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡∏•‡∏≤‡∏¢‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÄ‡∏î‡∏¥‡∏°";
            });

            document.getElementById('quiz-screen').classList.add('hidden');
            document.getElementById('result-screen').classList.remove('hidden');
            document.getElementById('final-score').innerText = `‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô ${score} / 10`;
            document.getElementById('final-time').innerText = `‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤ ${seconds} ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ`;

            // ‚úÖ ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏ú‡πà‡∏≤‡∏ô
            checkQuizPass(score);
        }

        function checkQuizPass(finalScore) {
            const passCriteria = 5; // ‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏ú‡πà‡∏≤‡∏ô 5 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
            if (finalScore >= passCriteria) {
                confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 }, colors: ['#00f2ff', '#fbbf24'] });
                document.getElementById('cert-section').style.display = 'block';
                localStorage.setItem('lastScore', finalScore);
            }
        }

        function generateCertificate() {
            const canvas = document.getElementById('certCanvas');
            const ctx = canvas.getContext('2d');
            const studentName = localStorage.getItem('studentName') || "‡∏ú‡∏π‡πâ‡∏Å‡∏•‡πâ‡∏≤ SmartCom";
            const studentScore = localStorage.getItem('lastScore') || "0";
            
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.strokeStyle = '#fbbf24'; 
            ctx.lineWidth = 25;
            ctx.strokeRect(40, 40, canvas.width - 80, canvas.height - 80);
            ctx.strokeStyle = '#1e293b'; 
            ctx.lineWidth = 2;
            ctx.strokeRect(65, 65, canvas.width - 130, canvas.height - 130);
            
            ctx.textAlign = 'center';
            ctx.fillStyle = '#1e293b';
            ctx.font = 'bold 50px Prompt';
            ctx.fillText('‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥‡∏ö‡∏±‡∏ï‡∏£‡∏â‡∏ö‡∏±‡∏ö‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡πÑ‡∏ß‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤', canvas.width / 2, 220);
            
            ctx.fillStyle = '#b45309'; 
            ctx.font = 'bold 85px Prompt';
            ctx.fillText(studentName, canvas.width / 2, 380);
            
            ctx.fillStyle = '#334155';
            ctx.font = '35px Prompt';
            ctx.fillText('‡πÑ‡∏î‡πâ‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ß‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏≠‡∏á‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö Computer Case', canvas.width / 2, 480);
            ctx.font = 'bold 42px Prompt';
            ctx.fillText(`‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏∞‡∏™‡∏°‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô ${studentScore} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô`, canvas.width / 2, 550);
            
            const date = new Date().toLocaleDateString('th-TH', { year: 'numeric', month: 'long', day: 'numeric' });
            ctx.font = '28px Prompt';
            ctx.fillStyle = '#64748b';
            ctx.fillText(`‡∏≠‡∏≠‡∏Å‡πÉ‡∏´‡πâ ‡∏ì ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${date}`, canvas.width / 2, 630);
            
            // --- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡πÅ‡∏•‡∏∞‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô ---
            ctx.font = 'italic 32px cursive'; // ‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡∏à‡∏≤‡∏Å 45px ‡πÄ‡∏´‡∏•‡∏∑‡∏≠ 32px
            ctx.fillStyle = '#1e3a8a';
            // ‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÉ‡∏´‡πâ‡∏Ç‡∏¢‡∏±‡∏ö‡∏°‡∏≤‡∏ó‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ (‡∏à‡∏≤‡∏Å -300 ‡πÄ‡∏õ‡πá‡∏ô -320) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏±‡∏ß‡∏£‡πå
            ctx.fillText('Computer Hardware AR', canvas.width - 320, 700); 
            
            ctx.beginPath();
            ctx.strokeStyle = '#1e3a8a';
            ctx.lineWidth = 2; // ‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤‡πÄ‡∏™‡πâ‡∏ô‡∏•‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡∏ï‡∏≤
            ctx.moveTo(canvas.width - 480, 715); // ‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏™‡πâ‡∏ô‡πÉ‡∏ï‡πâ‡πÉ‡∏´‡πâ‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
            ctx.lineTo(canvas.width - 160, 715);
            ctx.stroke();
            
            ctx.font = '22px Prompt'; // ‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô‡∏ß‡∏á‡πÄ‡∏•‡πá‡∏ö‡∏•‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢
            ctx.fillStyle = '#334155';
            ctx.fillText('(T.nuch SmartCom)', canvas.width - 320, 750);

            const link = document.createElement('a');
            link.download = `‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥‡∏ö‡∏±‡∏ï‡∏£_${studentName}.png`;
            link.href = canvas.toDataURL('image/png', 1.0);
            link.click();
        }
    </script>
</body>
</html>
